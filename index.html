<!DOCTYPE html>
<html>
<head>
  <title>YouTube Login Chat</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <button onclick="signInWithYouTube()">Sign in with YouTube</button>
  <div id="status"></div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCq74S-8b4maDXEKkDXwoaz28Y_Qf0N_34",
      authDomain: "livestreamchat-268a9.firebaseapp.com",
      databaseURL: "https://livestreamchat-268a9-default-rtdb.firebaseio.com",
      projectId: "livestreamchat-268a9",
      storageBucket: "livestreamchat-268a9.appspot.com",
      messagingSenderId: "761482927725",
      appId: "1:761482927725:web:7d525941da69c424bb6964"
    };

    firebase.initializeApp(firebaseConfig);

    async function signInWithYouTube() {
      const provider = new firebase.auth.GoogleAuthProvider();
      provider.addScope('https://www.googleapis.com/auth/youtube.readonly');

      try {
        const result = await firebase.auth().signInWithPopup(provider);
        const token = result.credential.accessToken;

        const response = await fetch(`https://www.googleapis.com/youtube/v3/channels?part=snippet&mine=true`, {
          headers: {
            Authorization: `Bearer ${token}`
          }
        });

        const data = await response.json();

        if (data.items && data.items.length > 0) {
          const channelName = data.items[0].snippet.title;
          document.getElementById("status").textContent = `Signed in as: ${channelName}`;
          // You can now send messages using channelName
        } else {
          document.getElementById("status").textContent = "Channel not found.";
        }

      } catch (error) {
        console.error("Sign-in failed:", error);
        document.getElementById("status").textContent = `Sign-in failed: ${error.message}`;
      }
    }
  </script>
</body>
</html>
